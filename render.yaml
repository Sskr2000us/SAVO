# Render Blueprint for SAVO
# Deploy both backend API and frontend web app

services:
  # Backend FastAPI Service
  - type: web
    name: savo-api
    runtime: python
    pythonVersion: "3.12"
    region: oregon
    plan: free
    buildCommand: cd services/api && pip install -r requirements.txt
    startCommand: cd services/api && uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: SAVO_PROMPT_PACK_PATH
        value: ../../docs/spec/prompt-pack.gpt-5.2.json
      # Dual-Provider Architecture (optimized for quality and cost):
      # - Vision tasks (image scanning): Google Gemini Vision
      # - Reasoning tasks (planning, recipes): OpenAI GPT for structured outputs
      # Set these in Render dashboard as secret environment variables:
      # 
      # REQUIRED:
      # - SAVO_VISION_PROVIDER=google (for ingredient scanning)
      # - SAVO_REASONING_PROVIDER=openai (for meal planning, recipes, YouTube ranking)
      # - GOOGLE_API_KEY (required for vision tasks)
      # - OPENAI_API_KEY (required for reasoning tasks)
      #
      # OPTIONAL:
      # - GOOGLE_MODEL (default: gemini-2.5-flash)
      # - OPENAI_MODEL (default: gpt-4-turbo-preview)
      # - SAVO_LLM_FALLBACK_PROVIDER (backup provider for rate limits)
      # - ANTHROPIC_API_KEY (if using Anthropic as fallback)
      # - LLM_TIMEOUT (default: 60)
      #
      # LEGACY (backward compatibility):
      # - SAVO_LLM_PROVIDER (will be used if SAVO_REASONING_PROVIDER not set)
    healthCheckPath: /health

  # Flutter Web App (Static Site)
  # Note: Render doesn't natively support Flutter builds
  # You have two options:
  # 1. Build locally and deploy dist/ folder to Render Static Site
  # 2. Use a custom Docker build (see Dockerfile below)
  # 3. Deploy Flutter web to Netlify/Vercel instead
